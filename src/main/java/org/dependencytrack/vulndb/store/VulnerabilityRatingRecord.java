package org.dependencytrack.vulndb.store;

import org.dependencytrack.vulndb.api.Rating;
import org.dependencytrack.vulndb.api.Source;
import org.jspecify.annotations.Nullable;

import java.time.Instant;

public record VulnerabilityRatingRecord(
        String sourceName,
        String vulnId,
        String method,
        String severity,
        @Nullable String vector,
        @Nullable Double score,
        Instant createdAt,
        @Nullable Instant updatedAt) {

    static VulnerabilityRatingRecord of(final Source source, final String vulnId, final Rating rating) {
        return new VulnerabilityRatingRecord(
                source.name(),
                vulnId,
                rating.method().name().replace("_", "."),
                rating.severity().name().toLowerCase(),
                rating.vector(),
                rating.score(),
                null,
                null);
    }

}
